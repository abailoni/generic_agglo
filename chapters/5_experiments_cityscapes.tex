% !TEX root = ../agglo_clust_review.tex
\section{Experiments on CityScapes}\label{sec:cityscapes_exp}
We also evaluate the performances of \algname{} on the CityScapes dataset \cite{cordts2016cityscapes}, which consists of 5000 street-scene images recorded by car-mounted cameras with resolution 1024$\times$2048: 2975 images for training, 500 for validation and 1525 for testing. Objects with instance-level annotations belong to the following classes: person, rider, car, truck, bus, train, motorcycle, bicycle. For our experiments, we used the state-of-the-art proposal-free pipeline proposed in \cite{liu2018affinity} (GMIS) that achieved superior performances compared to other proposal-based methods like Mark R-CNN and employs a similar model to the one applied by us on neuron-segmentation.
Their trained model was publicly available, so we simply replaced their final graph-merging algorithm (GMIS-Agglo) with \algname{}. See Appendix \ref{sec:cityscapes_appendix} for more details on how we fine-tuned their instance branch model by using a \emph{S\o resen-Dice} loss similarly to \cite{wolf2018mutex} and obtained in this way sharper affinity-predictions.

Results are summarized in Table \ref{tab:results_cityscapes_val} and confirm our findings on neuron-segmentation: \algname{} with average linkage achieves the best scores, whereas other linkage tend to introduce more false region-splits, like \emph{Abs. Max.}, or false region-merge, like \emph{Sum}. GMIS-Agglo requires the user to tune several threshold parameters and it was probably tailored to the original affinities predicted by \cite{liu2018affinity}, so it did not generalize well to our fine-tuned model and it achieved lower scores compared to the original AP value of 34.1 in \cite{liu2018affinity}.  




% \begin{table}
%     \centering
%     \begin{subtable}[t!]{0.5\textwidth}\centering
%         \begin{tabular}{c|| c| c| c |c }
%         & \multicolumn{4}{c}{\thead{Add Cannot-Link-Constraints:}} \\
%         & \multicolumn{2}{c}{\thead{\textsc{No}}} & \multicolumn{2}{c}{\thead{\textsc{Yes}}} \\
%          & \multicolumn{1}{c}{\thead{$\beta$}}  & \thead{AP} & \multicolumn{1}{c}{\thead{$\beta$}} & \thead{AP} \\ \midrule\midrule
% Sum & 0.55  & {\color{Orange} 0.313 } & 0.55  & {\color{Orange} 0.319 } \\\midrule
% Abs. Max. & 0.45  & {\color{Orange} 0.321 } & & \\\midrule
% \textbf{Mean}& \textbf{0.35 } & {\color{ForestGreen} \textbf{0.343} } & 0.25  & {\color{Orange} 0.339 } \\\midrule

% Max & 0.85 & {\color{Red} 0.243 } & 0.50  & {\color{Orange} 0.325 } \\\midrule
% Min & 0.50  & {\color{Red} 0.000 } & 0.50  & {\color{Red} 0.000 } \\\midrule
% \cite{liu2018affinity} & -  & {\color{ForestGreen} 0.341 } & - & - \\

%         \end{tabular}
%         % \caption{Linkage criteria}
%     \end{subtable} 
%     \caption{Results on cityscapes validation set (with finetuned affinities). \TODO{Reformat in the usual form, delete colors, less digits}}
%     \label{tab:results_cityscapes}
% \end{table}





% \begin{table*}
%     \centering
%     \begin{subtable}[t!]{0.98\textwidth}\centering
%         \begin{tabular}{c| c| c | c}
%         Update rule & \makecell{Use Cannot-Link\\Constraints} & AP & AP 50\%\\ \midrule\midrule
% GMIS & - & {\color{ForestGreen} 0.3409 } & {\color{ForestGreen} 0.5465 } \\
% mean & False & {\color{Orange} 0.3359 } & {\color{ForestGreen} 0.5416 } \\
% mean & True & {\color{Orange} 0.3315 } & {\color{ForestGreen} 0.5331 } \\
% MutexWatershed & True & {\color{Red} 0.2123 } & {\color{Red} 0.3848 } \\
% SingleLinkage & False & {\color{Red} 0.1935 } & {\color{Red} 0.3615 } \\
% CompleteLinkage & False & {\color{Red} 0.0000 } & {\color{Red} 0.0000 } \\


%         \end{tabular}
%         % \caption{Linkage criteria}
%     \end{subtable} 
%     \caption{Scores on cityscapes validation set (original affinities trained by GMIS)}
%     \label{tab:linkage-criteria}
% \end{table*}
